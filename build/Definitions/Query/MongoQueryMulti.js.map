{"version":3,"sources":["../source/Definitions/Query/MongoQueryMulti.ts"],"names":[],"mappings":";;;;;;;;;;;;AACA,2CAA0C;AAG1C;IAAgE,mCAAe;IAA/E;;IAgEA,CAAC;IA9DA,8BAAI,GAAJ,UAAqC,WAAmF,EAAE,UAAmF;QAE5M,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC,IAAI,CAAE,WAAW,EAAE,UAAU,CAAE,CAAC;IACpD,CAAC;IAED,+BAAK,GAAL,UAAuB,UAAiF;QAEvG,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IACtC,CAAC;IAED,8BAAI,GAAJ;QAAA,iBAoBC;QAlBA,OAAO,IAAI,OAAO,CAAE,UAAC,OAAO,EAAE,MAAW;YACxC,IAAG,KAAI,CAAC,MAAM,EACd;gBACC,KAAI,CAAC,MAAM,EAAE,CAAC,OAAO,EAAE,CAAC,IAAI,CAAE,UAAA,KAAK;oBAClC,OAAO,CAAC,KAAK,CAAC,CAAC;gBAChB,CAAC,CAAC,CAAC;gBACH,OAAO;aACP;YAED,KAAI,CAAC,MAAM,EAAE,CAAC,OAAO,EAAE,CAAC,IAAI,CAAE,UAAA,KAAK;gBAClC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAE,UAAA,QAAQ;oBAC1B,IAAI,QAAQ,GAAQ,KAAI,CAAC,UAAU,CAAC,mBAAmB,CAAS,KAAI,CAAC,UAAU,CAAC,CAAC;oBACjF,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;oBAC3B,OAAO,QAAQ,CAAC;gBACjB,CAAC,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QAEJ,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,iCAAO,GAAP,UAAQ,QAAQ,EAAE,IAAK;QAAvB,iBA6BC;QA3BA,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,OAAO,EAAE,CAAC;QACrC,IAAG,IAAI,CAAC,MAAM,EACd;YACC,IAAI,CAAC,MAAM,EAAE,CAAC,OAAO,EAAE,CAAC,IAAI,CAAE,UAAA,KAAK;gBAClC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;gBACxB,IAAG,IAAI,EACP;oBACC,IAAI,EAAE,CAAC;iBACP;YACF,CAAC,CAAC,CAAA;YACF,OAAO;SACP;QAED,MAAM,CAAC,IAAI,CAAE,UAAA,KAAK;YACjB,KAAK,CAAC,OAAO,CAAE,UAAA,IAAI;gBAClB,IAAI,QAAQ,GAAQ,KAAI,CAAC,UAAU,CAAC,mBAAmB,CAAS,KAAI,CAAC,UAAU,CAAC,CAAC;gBACjF,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBACvB,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACpB,CAAC,CAAC,CAAC;YACH,IAAG,IAAI,EACP;gBACC,IAAI,EAAE,CAAC;aACP;QACF,CAAC,CAAC,CAAC;QAGH,WAAW;IACZ,CAAC;IACF,sBAAC;AAAD,CAhEA,AAgEC,CAhE+D,uBAAU,GAgEzE;AAhEY,0CAAe;AAgE3B,CAAC","file":"MongoQueryMulti.js","sourcesContent":["import { Db, Collection, Cursor, AggregationCursor } from \"mongodb\";\nimport { MongoQuery } from \"./MongoQuery\";\nimport { MongoCollection } from \"../MongoCollection\";\n\nexport class MongoQueryMulti<T extends MongoCollection> extends MongoQuery<T[]>\n{\n\tthen<TResult1 = T, TResult2 = never>(onfulfilled?: ((value: T[]) => TResult1 | PromiseLike<TResult1>) | undefined | null, onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null): Promise<TResult1 | TResult2>\n\t{\n\t\treturn this.exec().then( onfulfilled, onrejected );\n\t}\n\n\tcatch<TResult = never>(onrejected?: ((reason: any) => TResult | PromiseLike<TResult>) | undefined | null): Promise<T[] | TResult>\n\t{\n\t\treturn this.exec().catch(onrejected);\n\t}\n\n\texec(): Promise<T[]>\n\t{\n\t\treturn new Promise( (resolve, reject: any) => {\n\t\t\tif(this.isLean)\n\t\t\t{\n\t\t\t\tthis.cursor().toArray().then( array => {\n\t\t\t\t\tresolve(array);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tthis.cursor().toArray().then( array => {\n\t\t\t\tresolve(array.map( document => {\n\t\t\t\t\tlet instance: any = this.collection.constructCollection<T>(<any>this.collection);\n\t\t\t\t\tinstance.hydrate(document);\n\t\t\t\t\treturn instance;\n\t\t\t\t}));\n\t\t\t});\n\n\t\t});\n\t}\n\n\tforEach(callback, done?)\n\t{\n\t\tlet cursor = this.cursor().toArray();\n\t\tif(this.isLean)\n\t\t{\n\t\t\tthis.cursor().toArray().then( array => {\n\t\t\t\tarray.forEach(callback);\n\t\t\t\tif(done)\n\t\t\t\t{\n\t\t\t\t\tdone();\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tcursor.then( array => {\n\t\t\tarray.forEach( data => {\n\t\t\t\tvar instance: any = this.collection.constructCollection<T>(<any>this.collection);\n\t\t\t\tinstance.hydrate(data);\n\t\t\t\tcallback(instance);\n\t\t\t});\n\t\t\tif(done)\n\t\t\t{\n\t\t\t\tdone();\n\t\t\t}\n\t\t});\n\t\t\n\t\t\n\t\t//cursor.to\n\t}\n};"]}